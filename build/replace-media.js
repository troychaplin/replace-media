(()=>{"use strict";const e=window.wp.i18n;document.addEventListener("DOMContentLoaded",(function(){function t(t){if("undefined"!=typeof wp&&wp.data&&wp.data.dispatch("core/notices"))try{return void wp.data.dispatch("core/notices").createErrorNotice(t)}catch(e){console.error("Notice system error:",e)}alert((0,e.__)("Error: ","replace-media")+t),console.error("Replace Media Error:",t)}function n(){document.querySelectorAll(".replace-media-button").forEach((e=>{e.removeEventListener("click",a),e.addEventListener("click",a)}))}function a(n){n.preventDefault();const a=this.getAttribute("data-attachment-id");if(!a)return;const i=document.createElement("input");i.type="file",i.style.display="none",document.body.appendChild(i);const d=this;i.addEventListener("change",(function(){if(0===this.files.length)return void document.body.removeChild(i);const n=this.files[0];d.disabled=!0,d.textContent=(0,e.__)("Checking…","replace-media"),function(t,n,a){const i=new FormData;return i.append("action","replace_media_file"),i.append("nonce",window.replaceMediaData.nonce),i.append("attachment_id",t),i.append("replacement_file",n),i.append("check_dimensions_only","1"),fetch(window.replaceMediaData.ajaxUrl,{method:"POST",body:i,credentials:"same-origin"}).then((e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()})).then((t=>{if(!t.success)throw new Error(t.data||(0,e.__)("Error checking file dimensions.","replace-media"));t.data.skip_check?a(!0):t.data.dimension_warning?function(t,n,a){const i=document.createElement("div");i.style.cssText="\n\t\t\tposition: fixed;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tbackground: rgba(0, 0, 0, 0.5);\n\t\t\tz-index: 100000;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t";const d=document.createElement("div");d.style.cssText="\n\t\t\tbackground: white;\n\t\t\tpadding: 20px;\n\t\t\tborder-radius: 4px;\n\t\t\tmax-width: 500px;\n\t\t\tbox-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n\t\t";const c=document.createElement("p");c.textContent=t,c.style.margin="0";const o=document.createElement("div");o.style.cssText="text-align: right; margin-top: 20px;";const r=document.createElement("button");r.textContent=(0,e.__)("Cancel","replace-media"),r.className="button",r.style.marginRight="10px";const l=document.createElement("button");l.textContent=(0,e.__)("Proceed","replace-media"),l.className="button button-primary",r.addEventListener("click",(function(){document.body.removeChild(i),a&&a()})),l.addEventListener("click",(function(){document.body.removeChild(i),n&&n()})),i.addEventListener("click",(function(e){e.target===i&&(document.body.removeChild(i),a&&a())})),o.appendChild(r),o.appendChild(l),d.appendChild(c),d.appendChild(o),i.appendChild(d),document.body.appendChild(i)}(t.data.message,(()=>a(!0)),(()=>a(!1))):a(!0)}))}(a,n,(function(i){i?(d.textContent=(0,e.__)("Replacing…","replace-media"),function(n,a,i){const d=new FormData;d.append("action","replace_media_file"),d.append("nonce",window.replaceMediaData.nonce),d.append("attachment_id",n),d.append("replacement_file",a),d.append("dimension_confirmed","true"),fetch(window.replaceMediaData.ajaxUrl,{method:"POST",body:d,credentials:"same-origin"}).then((e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()})).then((n=>{n.success?window.location.reload():(t(n.data||(0,e.__)("Error replacing file.","replace-media")),i&&(i.disabled=!1,i.textContent=(0,e.__)("Replace File","replace-media")))})).catch((n=>{t((0,e.__)("Error replacing file: ","replace-media")+n.message),i&&(i.disabled=!1,i.textContent=(0,e.__)("Replace File","replace-media"))}))}(a,n,d)):(d.disabled=!1,d.textContent=(0,e.__)("Replace File","replace-media"))})).catch((n=>{t(n.message),d.disabled=!1,d.textContent=(0,e.__)("Replace File","replace-media")})),document.body.removeChild(i)})),i.click()}void 0!==window.replaceMediaData&&(n(),wp.media&&wp.media.frame&&wp.media.frame.on("open",n),document.addEventListener("click",(function(e){e.target&&e.target.classList.contains("attachment-details")&&n()})))}))})();